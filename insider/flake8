#!/usr/bin/env bash
set -e
[ "$VERBOSE" -lt 1 ] || set -x

# Check addons exist
INCLUDE_LINT="$(addons list -fs ' ' $ADDON_CATEGORIES)" || exit 0
export INCLUDE_LINT

# Dependencies
cd "$(mktemp -d)"
git clone -q --depth 100 https://github.com/OCA/maintainer-quality-tools.git .
# HACK https://github.com/OCA/maintainer-quality-tools/pull/520
git config user.email "info@tecnativa.com"
git config user.name "Doodba QA"
git pull -q origin pull/520/head
pip install -q --user flake8
export PATH="$PATH:$(pwd)/travis"

# Lint
test_flake8
